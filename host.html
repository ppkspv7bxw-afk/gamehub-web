<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Gamehub4u - استضافة</title>
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      min-height:100vh;
      color:#fff;
      font-family:system-ui,sans-serif;
      background:linear-gradient(165deg,#0a0415,#1a0820);
      display:flex;
      align-items:center;
      justify-content:center;
      padding:20px
    }
    .wrap{
      width:min(600px,100%);
      background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.16);
      border-radius:20px;
      padding:30px;
      backdrop-filter:blur(16px)
    }
    .logo{text-align:center;margin-bottom:30px}
    .logo img{width:min(350px,80vw);height:auto}
    h1{font-size:24px;margin-bottom:20px;text-align:center}
    .room-box{
      background:rgba(255,255,255,.03);
      border:2px solid rgba(255,255,255,.16);
      border-radius:18px;
      padding:25px;
      margin-bottom:20px;
      text-align:center;
      transition:all .3s
    }
    .room-box.active{
      border-color:rgba(255,61,107,.35);
      background:rgba(255,27,58,.08);
      box-shadow:0 0 0 1px rgba(255,61,107,.2),0 8px 24px rgba(255,27,58,.15)
    }
    .room-label{
      font-size:14px;
      color:rgba(255,255,255,.65);
      margin-bottom:12px
    }
    .room-code{
      font-size:42px;
      font-weight:900;
      letter-spacing:10px;
      font-family:monospace;
      background:linear-gradient(135deg,rgba(255,255,255,.94),rgba(255,255,255,.7));
      -webkit-background-clip:text;
      background-clip:text;
      -webkit-text-fill-color:transparent;
      filter:drop-shadow(0 2px 8px rgba(255,27,58,.3));
      transition:all .3s;
      user-select:all;
      margin-bottom:15px
    }
    .room-code.placeholder{
      opacity:.3;
      letter-spacing:8px;
      filter:none
    }
    .quick-btns{
      display:flex;
      gap:8px;
      justify-content:center
    }
    .icon-btn{
      width:48px;
      height:48px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.18);
      background:rgba(0,0,0,.25);
      color:#fff;
      cursor:pointer;
      transition:all .2s;
      display:flex;
      align-items:center;
      justify-content:center
    }
    .icon-btn:hover{
      background:rgba(255,255,255,.1);
      transform:translateY(-2px)
    }
    .icon-btn svg{width:20px;height:20px;opacity:.9}
    .info-box{
      background:rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.12);
      border-radius:14px;
      padding:14px 16px;
      font-size:13px;
      line-height:1.6;
      color:rgba(255,255,255,.65);
      margin-bottom:20px;
      display:flex;
      gap:12px
    }
    .info-box svg{
      width:18px;
      height:18px;
      flex-shrink:0;
      opacity:.7;
      margin-top:2px
    }
    .actions{display:flex;gap:12px;flex-wrap:wrap}
    .btn{
      flex:1;
      min-width:140px;
      padding:14px 20px;
      border:none;
      border-radius:12px;
      font-size:15px;
      font-weight:700;
      color:#fff;
      background:linear-gradient(135deg,#ff1b3a,#ff3d6b);
      cursor:pointer;
      transition:transform .2s;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:8px
    }
    .btn:hover{transform:translateY(-2px)}
    .btn:disabled{opacity:.5;cursor:not-allowed;transform:none}
    .btn.secondary{
      background:rgba(255,255,255,.1);
      border:1px solid rgba(255,255,255,.2)
    }
    .spinner{
      width:16px;
      height:16px;
      border:2px solid rgba(255,255,255,.3);
      border-top-color:#fff;
      border-radius:50%;
      animation:spin .8s linear infinite
    }
    @keyframes spin{to{transform:rotate(360deg)}}
    .toast{
      position:fixed;
      bottom:30px;
      left:50%;
      transform:translateX(-50%) translateY(100px);
      background:rgba(0,0,0,.9);
      color:#fff;
      padding:12px 24px;
      border-radius:12px;
      font-size:14px;
      font-weight:600;
      opacity:0;
      transition:all .3s;
      z-index:1000;
      backdrop-filter:blur(10px)
    }
    .toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
    @media(max-width:600px){
      .room-code{font-size:36px;letter-spacing:8px}
      .actions{flex-direction:column}
      .btn{width:100%}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="logo">
      <img src="/logo.png" alt="Gamehub4u">
    </div>
    <h1>استضافة غرفة جديدة</h1>
    <div class="room-box" id="roomBox">
      <div class="room-label">كود الغرفة</div>
      <div class="room-code placeholder" id="roomCode">----</div>
      <div class="quick-btns" id="quickBtns" style="display:none">
        <button class="icon-btn" id="copyCodeBtn" title="نسخ الكود">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke-width="2"/>
            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" stroke-width="2"/>
          </svg>
        </button>
        <button class="icon-btn" id="copyLinkBtn" title="نسخ الرابط">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" stroke-width="2" stroke-linecap="round"/>
            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>
    </div>
    <div class="info-box">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <circle cx="12" cy="12" r="10" stroke-width="2"/>
        <line x1="12" y1="16" x2="12" y2="12" stroke-width="2" stroke-linecap="round"/>
        <circle cx="12" cy="8" r="0.5" fill="currentColor" stroke="none"/>
      </svg>
      <div>بعد إنشاء الغرفة، شارك الكود أو الرابط مع أصدقائك للانضمام.</div>
    </div>
    <div class="actions">
      <button class="btn" id="createBtn">
        <span id="createText">إنشاء غرفة جديدة</span>
      </button>
      <button class="btn secondary" id="startBtn" style="display:none">ابدأ اللعبة</button>
      <button class="btn secondary" id="backBtn">رجوع</button>
    </div>
  </div>
  <div class="toast" id="toast"></div>
  <script>
    function makeRoomCode(){
      const chars='ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
      let code='';
      for(let i=0;i<4;i++)code+=chars[Math.floor(Math.random()*chars.length)];
      return code
    }
    function showToast(msg){
      const toast=document.getElementById('toast');
      toast.textContent=msg;
      toast.classList.add('show');
      setTimeout(()=>toast.classList.remove('show'),2000)
    }
    async function copyText(text){
      try{
        await navigator.clipboard.writeText(text);
        showToast('تم النسخ ✓')
      }catch(e){
        showToast('فشل النسخ')
      }
    }
    const roomCodeEl=document.getElementById('roomCode');
    const roomBox=document.getElementById('roomBox');
    const quickBtns=document.getElementById('quickBtns');
    const createBtn=document.getElementById('createBtn');
    const createText=document.getElementById('createText');
    const startBtn=document.getElementById('startBtn');
    const backBtn=document.getElementById('backBtn');
    const copyCodeBtn=document.getElementById('copyCodeBtn');
    const copyLinkBtn=document.getElementById('copyLinkBtn');
    let currentRoom='';
    createBtn.onclick=()=>{
      const code=makeRoomCode();
      currentRoom=code;
      roomCodeEl.textContent=code;
      roomCodeEl.classList.remove('placeholder');
      roomBox.classList.add('active');
      quickBtns.style.display='flex';
      startBtn.style.display='inline-flex';
      createBtn.disabled=true;
      createText.textContent='تم إنشاء الغرفة ✓';
      localStorage.setItem('gh_lastRoom',code);
      showToast('تم إنشاء الغرفة ✓')
    };
    copyCodeBtn.onclick=()=>{
      if(!currentRoom)return showToast('لا يوجد كود');
      copyText(currentRoom)
    };
    copyLinkBtn.onclick=()=>{
      if(!currentRoom)return showToast('لا يوجد كود');
      const link=location.origin+'/?room='+currentRoom;
      copyText(link)
    };
    startBtn.onclick=()=>{
      if(!currentRoom)return showToast('لا يوجد غرفة');
      location.href='/lobby.html?room='+currentRoom
    };
    backBtn.onclick=()=>location.href='/';
    const urlParams=new URLSearchParams(location.search);
    const roomFromUrl=urlParams.get('room');
    if(roomFromUrl){
      currentRoom=roomFromUrl;
      roomCodeEl.textContent=roomFromUrl;
      roomCodeEl.classList.remove('placeholder');
      roomBox.classList.add('active');
      quickBtns.style.display='flex';
      startBtn.style.display='inline-flex';
      createBtn.disabled=true;
      createText.textContent='تم إنشاء الغرفة ✓'
    }else{
      const last=localStorage.getItem('gh_lastRoom');
      if(last){
        currentRoom=last;
        roomCodeEl.textContent=last;
        roomCodeEl.classList.remove('placeholder');
        roomBox.classList.add('active');
        quickBtns.style.display='flex';
        startBtn.style.display='inline-flex';
        createBtn.disabled=true;
        createText.textContent='تم إنشاء الغرفة ✓'
      }
    }
  </script>
</body>
</html>
